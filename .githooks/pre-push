#!/bin/bash
# Pre-push hook for quality gates

echo "üîç Pre-push validation starting..."

# Run quality gates
echo "Running PHPStan..."
vendor/bin/phpstan analyse --no-progress --memory-limit=1G
if [ $? -ne 0 ]; then
    echo "‚ùå PHPStan failed"
    exit 1
fi

echo "Running Pint..."
vendor/bin/pint --test > /dev/null
if [ $? -ne 0 ]; then
    echo "‚ùå Pint failed"  
    exit 1
fi

echo "Running TODO sweeper..."
python3 scripts/todo_sweeper.py --count-only | grep -q "^0$"
if [ $? -ne 0 ]; then
    echo "‚ùå TODO violations found"
    exit 1
fi

echo "‚úÖ All quality gates passed - push approved"
exit 0

